# 管理员账号管理指南

## 📋 功能概述

管理员可以在后台管理自己的账号信息和密码，确保账号安全。

---

## 🔑 访问账号管理

1. 登录管理后台: `https://your-domain.com/admin`
2. 点击顶部导航栏的 **"系统设置"** 标签
3. 在页面顶部可以看到 **"账号管理"** 区域

---

## 👤 账号信息

在账号管理区域，您可以查看:

- **邮箱**: 当前登录的管理员邮箱
- **角色**: 显示为 "管理员"

---

## 🔐 修改密码

### 步骤

1. 在 **"修改密码"** 卡片中填写:
   - **当前密码**: 输入您当前的密码
   - **新密码**: 输入新密码 (至少 6 位)
   - **确认新密码**: 再次输入新密码

2. 点击 **"修改密码"** 按钮

3. 修改成功后:
   - 系统会提示 "密码修改成功,请重新登录"
   - 自动退出登录
   - 跳转到登录页面

4. 使用新密码重新登录

### 密码要求

- ✅ 最少 6 位字符
- ✅ 建议使用字母、数字、特殊字符组合
- ✅ 定期更换密码以提高安全性

### 注意事项

⚠️ **重要提示**:
- 修改密码后需要立即重新登录
- 请妥善保管新密码
- 如果忘记密码，需要通过数据库重置

---

## 🔧 API 接口

### 1. 修改密码

**接口**: `POST /api/auth/change-password`

**请求头**:
```
Authorization: Bearer <token>
Content-Type: application/json
```

**请求体**:
```json
{
  "currentPassword": "old_password",
  "newPassword": "new_password"
}
```

**响应**:
```json
{
  "message": "密码修改成功"
}
```

**错误响应**:
- `400`: 当前密码和新密码不能为空
- `400`: 新密码长度至少为 6 位
- `401`: 当前密码错误
- `404`: 用户不存在
- `500`: 修改密码失败

### 2. 更新用户信息

**接口**: `PUT /api/auth/profile`

**请求头**:
```
Authorization: Bearer <token>
Content-Type: application/json
```

**请求体**:
```json
{
  "full_name": "新名称",
  "email": "new_email@example.com"
}
```

**响应**:
```json
{
  "user": {
    "id": "user_id",
    "email": "new_email@example.com",
    "full_name": "新名称",
    "role": "admin",
    "created_at": "2024-01-01T00:00:00.000Z"
  }
}
```

**错误响应**:
- `400`: 该邮箱已被使用
- `400`: 没有要更新的字段
- `500`: 更新用户信息失败

---

## 🛡️ 安全建议

### 密码安全

1. **使用强密码**:
   - 至少 8-12 位字符
   - 包含大小写字母、数字、特殊字符
   - 避免使用常见密码 (如: 123456, password)

2. **定期更换**:
   - 建议每 3-6 个月更换一次密码
   - 不要重复使用旧密码

3. **保密措施**:
   - 不要与他人分享密码
   - 不要在公共场所输入密码
   - 使用密码管理器存储密码

### 账号安全

1. **登录安全**:
   - 使用 HTTPS 访问管理后台
   - 不要在公共 WiFi 下登录
   - 及时退出登录

2. **监控异常**:
   - 定期检查订单和系统日志
   - 发现异常活动立即修改密码

---

## 🔄 密码重置 (数据库方式)

如果忘记密码，可以通过数据库直接重置:

### 方法 1: 使用 bcrypt 生成新密码哈希

```bash
# 在服务器上
cd /var/www/goods-store/backend
node -e "const bcrypt = require('bcryptjs'); console.log(bcrypt.hashSync('new_password', 10));"
```

复制输出的哈希值，然后更新数据库:

```sql
UPDATE users 
SET password_hash = '复制的哈希值', updated_at = CURRENT_TIMESTAMP 
WHERE email = 'admin@shop.com';
```

### 方法 2: 使用初始化脚本

```bash
cd /var/www/goods-store/backend
node src/database/init.js
```

这会重置管理员密码为默认密码: `admin123`

⚠️ **重置后请立即登录并修改密码！**

---

## ❓ 常见问题

### Q: 修改密码后无法登录?
**A**: 
1. 确认新密码输入正确
2. 清除浏览器缓存和 Cookie
3. 如果仍无法登录，使用数据库重置密码

### Q: 可以修改邮箱吗?
**A**: 
目前前端界面只支持修改密码。如需修改邮箱，可以:
1. 使用 API 接口 `PUT /api/auth/profile`
2. 或直接在数据库中修改

### Q: 密码有复杂度要求吗?
**A**: 
目前只要求最少 6 位。建议使用强密码以提高安全性。

### Q: 可以创建多个管理员吗?
**A**: 
目前系统只支持一个管理员账号。如需多个管理员，需要修改数据库和代码。

---

## 📝 更新日志

- **2024-01-XX**: 添加账号管理功能
  - 支持修改密码
  - 支持更新用户信息
  - 添加密码长度验证
  - 修改密码后自动退出登录

